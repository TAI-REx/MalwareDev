import string, sys, random

try:
    plaintext = open(sys.argv[1], 'rb').read()
except:
    print("\nYou must specify a shellcode file as input \n\nExample Usage: python3 xor.py shellcode.bin")
    sys.exit()

def genkey():
    letters = string.ascii_letters
    key = ""
    for i in range(5):
        z = random.choice(letters)
        key = key + z
    return key

def xor(data, key):
    output_str = ""

    for i in range(len(data)):
        current = data[i]
        current_key = key[i % len(key)]
        o = lambda x: x if isinstance(x, int) else ord(x)
        output_str += chr(o(current) ^ ord(current_key))

    ciphertext = '{ 0x' + ', 0x'.join(hex(ord(x))[2:] for x in output_str) + ' };'
    return ciphertext

xorKey = genkey()
print("xor key = " + xorKey + "\n\n")

y = xor(plaintext, xorKey)
print(y)
